dnl Process this file with autoconf to produce a configure script.
AC_INIT(src/matrices/matrices.c)
AC_CONFIG_HEADER(src/config.h)

AC_ARG_ENABLE(single, [  --enable-single          compile for single precision], ok=$enableval, ok=no)
if test "$ok" = "yes"; then
        AC_DEFINE(SCALAR_SINGLE_PREC)
fi

AC_ARG_ENABLE(complex, [  --enable-complex        use complex numbers (don't require inv. sym.)], ok=$enableval, ok=yes)
if test "$ok" = "yes"; then
        AC_DEFINE(SCALAR_COMPLEX)
fi

dnl Checks for programs.
AC_PROG_CC
AC_PROG_RANLIB
AC_PROG_MAKE_SET

# Use native cc if present
AC_MSG_CHECKING([for vendor's cc to be used instead of gcc])
AC_CHECK_PROG(CC, cc, cc)

CFLAGS="-O3"

AC_ARG_ENABLE(debug, [  --enable-debug           compile for debugging], ok=$enableval, ok=yes)
if test "$ok" = "yes"; then
	CFLAGS="-g"
else
	AC_DEFINE(CHECK_DISABLE)
fi

AC_ARG_WITH(fftw, [  --with-fftw=<dir>       specify fftw directory], ok=$withval, ok=yes)
if test "$ok" = "no"; then
        AC_ERROR(FFTW is required and you may not disable it)
elif test "$ok" != "yes"; then
	CFLAGS="$CFLAGS -I$ok"
	LDFLAGS="$LDFLAGS -L$ok"
fi

# Add path for config.h to include path:
CFLAGS="$CFLAGS -I`pwd`/src"

dnl Checks for libraries.
AC_CHECK_LIB(m, sqrt)

AC_F77_LIBRARY_LDFLAGS

dnl Check for FFTW libraries
AC_CHECK_LIB(fftw, fftw)
AC_CHECK_LIB(rfftw, rfftw)

dnl Checks for IBM ESSL library: -lessl
AC_CHECK_LIB(essl, dcft)

dnl Checks for BLAS & LAPACK libraries:
AC_CHECK_LIB(blas, main)
AC_CHECK_LIB(lapack, main)

dnl Checks for BLAS dgemm/sgemm libraries (produced by PhiPACK):
AC_CHECK_LIB(dgemm, main)
AC_CHECK_LIB(sgemm, main)

dnl Checks for header files.
AC_HEADER_STDC

dnl Checks for typedefs, structures, and compiler characteristics.
AC_C_CONST
AC_C_INLINE

AC_OUTPUT(Makefile tests/Makefile src/util/Makefile src/matrices/Makefile src/maxwell/Makefile)
